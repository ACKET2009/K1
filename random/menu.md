

<h1>Пункты меню хелпер скрипта.</h1>

Целью этого руководства является не перевод как таковой, а пояснение того, что не всегда очевидно простому пользователю.

Когда началось производство K1 серии оказалось что на борту вместо обычного линукса, в качестве операционной системы, установлен buildroot. это такой кастрированный вариант линукса в котором отсутсвуют библиотеки. А чтобы медом жизнь нам не казалось, компания сделала нестандартные пути установки и добавила свои модули которые несовместимы со стандартным klipper.  Все это делает невозможным установку модулей klipper привычными методами с помощью обычных сценариев установки. Через какое то время энтузиаст из франции под ником `Guilouz`  начал объединять в сценарии установки различные модификации выходящие к принтеру. На данный момент 95% того, что вам может пригодится для работы находится в нём. Я в свое время также принял участие в разработке, что можно проверить в разделе [**Special Thanks**](https://guilouz.github.io/Creality-Helper-Script-Wiki/special-thanks/)

Описание пунктов меню в оригинале вы всегда можете найти в вики хелпер скрипта [тут](https://guilouz.github.io/Creality-Helper-Script-Wiki/helper-script/moonraker-k1/)



![](/version_config/config.jpg)

Пройдемся подробней по пунктам меню. При нажатии вы увидите расширенную информацию.

<details><summary>1 Moonraker and Ngnix</summary>

   Ngnix это HTTP-сервер, обратный прокси сервер с поддержкой кеширования и балансировки нагрузки.

   Moonraker это веб-сервер, который предоставляет API, с помощью которых клиентские приложения могут взаимодействовать с прошивкой Klipper. Нужно это нам не только для взаимодействия с вебпанелью Fluid\Mainsail но и для связи с нашими слайсерами, чтобы они могли посылать файлы на печать.
</details>

<details><summary>2 Fluid</summary>

   Fluidd — это легкий и адаптивный пользовательский интерфейс для Klipper. C помощью него нам будет удобнее и легче получать доступ к различным параметрам и данным.

   если установили fluid доступ к нему будет по порту 4408

   например http://ip_адрес_принтера:4408



</details>

<details><summary>3 Mainsail</summary>

   Современный и отзывчивый пользовательский интерфейс для klipper. альтернатива Fluid. C помощью него нам будет удобнее и легче получать доступ к различным параметрам и данным.

   если установили Mainsail доступ к нему будет по порту 4409

   например http://ip_адрес_принтера:4409

</details>

<details><summary>4 Entware</summary>

   Это менеджер ПО для встраиваемых систем, который открывает доступ к огромному количеству (более 1800) пакетов программ для Linux, в нашем случае необходим для установки библиотек необходимых для работы некоторых пунктов. также в процессе установки сразу устанавливается пакет sftpd для удобного доступа к файловой системе. 
   
   *Огромное то оно конечно огромное, но далеко не всё что необходимо для работы современного клиппера, поэтому многие проекты вынуждены использовать дополнительные платы управления, или менять вообще всю начинку принтера.*

</details>

<details><summary>5 Klipper Gcode Shell Command</summary>

   Необходим для выполнения команд из klipper в среде линукс.
   Нужен для формирования графиков резонансов, формирования адаптивной сетки стола, работы бипера, алтернативного модуля таймлапсов.

</details>

<details><summary>6 Klipper Adaptive Meshing & Purging</summary>

   **Klipper Adaptive Meshing & Purging** — это расширение, которое позволяет вам генерировать сетку и линию очистки только в области платформы, используемой печатаемыми объектами. делится на две части: 
   
   **Adaptive Meshing** - Ададаптивная сетка стола.  При использовании метод автоматически настраивает параметры сетки на основе области, занимаемой определенными печатаемыми объектами. Чтобы это работало в слайсере должен быть пункт "Исключение обьектов" в орке раздел прочее обычно установлена по умолчанию, так же для удобства можно еще ставить галочку напротив "добавлять имя обьектов", однако есть информация что русские имена обьектов печати могут вызвать сбой алгоритма.



   **Purging** - Линия прочистки. также становится адаптивной, так как мы не используем всю площадь стола мы не знаем на какой высоте находится стандартная линия прочистки, во избежания косяков она делается на некотором удалении от наших моделей. в файле Kamp_settings.cfg который находится в папке KAMP есть раздел ей посвященный:

   ```
   variable_purge_height: 0.8                  # высота над столом. по умолчанию 0.8 мм
variable_tip_distance: 0                    # расстояние между филаментом и концом сопла перед прочисткой. по умочанию 0. не трогаем.
variable_purge_margin: 10                   # отступ от печатной модели. по умолчанию 10
variable_purge_amount: 50                   # длина линии прочистки. по умолчанию 50 мм.
variable_flow_rate: 12                      # обьемный расход во время прочистки. по умолчанию 12 мм кубических.
   ```
   Несколько комментариев. `variable_purge_margin:` отступ идет именно от моделей. Может быть как по стороне икс так и по игрек, но он не учитывает кайму и поддержки поэтому может вызвать наложение. Можно либо увеличить этот параметр, либо повернуть модель так, чтобы поддержки не оказались на пути линии прочистки или(что проще всего) перед печатью выключить `adaptive_purge_line`

   ![](/random/images/purge_line.jpg)

   `variable_flow_rate` может вызвать пробку уже на первых шагах вашей печати если вы печатаете TPU так как обычно обьемный расход на этих пластиках в районе 3-5 мм кубических и пластику гораздо проще намотаться на шестерню чем лезть в сопло. выход - отключить перед печатью как показано выше, или что предпочтительнее, в параметрах пластика найти вкладку "дополнительно" и вписать туда `_ADAPTIVE_PURGE_LINE_OFF` в начальный код и `_ADAPTIVE_PURGE_LINE_ON` в конечный код.

   ![](/random/images/tpu_filament.jpg)

   В составе пакета также входит модуль **virtual_pins** с помощью которого стало возможным делать в интерфейсе кнопки привязанные к сценариям, а не к физическиким выводам.
 

</details>

<details><summary>7 Buzzer Support</summary>

   Это позволяет использовать встроенный в материнскую плату бипер для воспроизведения звука при определенных действиях. Работает на к1\к1макс но не работает на к1с потому что на последних банально не распаян бипер. я предлагаю три сценария его использования, которые расписаны [**тут**](/ferma/readme.md) 
   
   Если у вас к1с есть 2 варианта решения, либо купить активный бипер и впаять его в материнскую плату, либо найти в [**руководстве**](/usb/readme.md) раздел *beeper* и реализовать пассивный бипер что позволит вам не просто слушать писк но и включать имперский марш по окончании печати :stuck_out_tongue_winking_eye:
 
</details>

<details><summary>8 Nozle Cleaning Fan Control</summary>

   Изменение логики работы вентиляторов во время прочистки сопла.  Небольшое ускорение работы алгоритма. 

</details>


<details><summary>9 Fans Control Macros</summary>

   Изменение логики работы вентиляторов во время работы принтера. Объединение сущностей принтера в новые управляемые обьекты.

   1. **chamber fan** - объедениние температурного датчика камеры принтера и заднего вентилятора.  при превышении пороговой температуры *по умолчанию 35 градусов* задний вентилятор включаетсяя высасывая излишне теплый воздух и подкачивая холодный, таким образом стабилизируя температуру печати.

   Не стоит надеяться на этот вентилятор при печати легкоплавкими пластиками типа ПЛА и PETG так как находится он не на самом верху и не обладает большим расходом воздуха. для печати этими пластиками вам придется либо открывать верхнюю крышку либо использовать проставки между крышкой и корпусом с дополнительными отверстиями для вентиляции. 
 
   В основном *chamber fan* нужен нам для печати Абс-подобными пластиками которые любят не столько высокую температуру печати, сколько стабильно-высокую температуру.  Можно, конечно, выставлять температуру в вебпанели непосредственно перед печатью. Однако гораздо правильнее будет добавить несколько записей в наш профиль филамента:

   ![](/random/images/temp_settings.jpg) 

   ставим температуру печати, однако если мы поставим галку "включить контроль температуры" то печать не начнется до того как в камере не наберется данная температура. это обычно не нужно, так как при печати на первых слоях горячий стол и так создает воздушную рубашку повышенной температуры вокруг модели но если мы ограничимся только установкой температуры орка не передаст данные в принтер. Чтобы это произошло, нам необходимо во вкладке дополнительно вписать `M141 S{overall_chamber_temperature` как это показано на картинке.

   ![](/random/images/temp_settings2.jpg)



   2. **Soc Fan** Это вентилятор обдува материнской платы который расположен под днищем нашего принтера. по умолчанию в родной прошивке логика его работы что он включается если включены моторы осей. После установки данного пункта его логика меняется на более правильную. по умолчанию у нас установлена температура 45. внутри конфига дельта 2, тоесть при достижении 45+2=47 градусов наш кулер включается и охлаждает плату до температуры 45-2=43 градусов после этого выключается. Это обеспечивает не только более тихую работу принтера но и экономит ресурс кулера. 
   
   **Внимание!** где-то среди китайских скриптов есть макрос который проверяет работу кулера материнской платы ВО ВРЕМЯ ПЕЧАТИ и если он в этот момент выключен, выдает на экране принтера предупреждение об ошибке вентилятора материнской платы.

   ![](/random/images/502.jpg)

   **ничего страшного в этом нет**, как вы прочитали выше, мы сами лучше знаем как нам надо, поэтому вывод простой - не обращать внимания на данную ошибку.




</details>


<details><summary>10 Improved Shapers Calibrations</summary>

   По умолчанию в прошивке от Creality измеряется только шейпер по игрек и копируется на икс, а чтоб этот трюк прокатил то прошивка берет шейпер один из широких шейперов ei.  зачем так было сделано? да потому что вечноподклинивающая ось икс может такого там подобрать что принтер будет как хромая корова.

   в процессе установке этого безусловно важного пункта также добавляется возможность создавать графики резонансов для анализа и последующих исправлений в кинематике, подробно о шейперах [**тут**](https://github.com/Tombraider2006/klipperFB6/tree/main/accel_graph), подробно о шейперах и исправлениях конкретно моделей серии К1 [**тут**](https://github.com/Tombraider2006/K1/tree/main/shaper). Подробное о том как работать с графиками натяжения ремней [**тут**](https://github.com/Tombraider2006/K1/tree/main/random/belts).

   если вам вдруг приперло использовать **guppy screen** то этот пункт вам не нужен, все это есть в его составе.

   Также во время выполнения тестов резонансов температура `Soc Fan` переустанавливается с 45 градусов на 30 градусов. Так как тесты эти дают большую нагрузку не только на драйверы двигателей но и на процессор это полезно и призвано предотвратить перегрев. Мы это можем использовать как маркер того что тест еще идет и не заглядывать в папку в поисках графиков раньше времени. 

   Пункт добавляет три  макроса. `input_shaper_calibration` `test_resonance_graphs` и `belts_shaper_calibration` как систематизировать полезные макросы в отдельный раздел написано [**тут**](https://github.com/Tombraider2006/K1/tree/main/macros_helpfull) 

</details>


<details><summary>11 Useful macros</summary>

   Как ясно из названия пункт добавляет полезные ~~и не очень~~ макросы.
   * KLIPPER_BACKUP_CONFIG
   * KLIPPER_RESTORE_CONFIG
   * MOONRAKER_BACKUP_DATABASE
   * MOONRAKER_RESTORE_DATABASE
   * RELOAD_CAMERA
   * BED_LEVELING
   * PID_BED
   * PID_HOTEND
   * WARMUP

   Про полезные макросы написано [**тут**](https://github.com/Tombraider2006/K1/tree/main/macros_helpfull)

   Отдельно повторю что `pid_bed` нужен только в к1макс потому что у него грелка стола на 220 вольт и поэтому регулировка мощности нагрева ему полезезна, для к1\к1с применяется другой алгоритм нагрева и данный макрос не нужен.

</details>


<details><summary>12 Save Z-Offset Macros</summary>

   Это позволяет автоматически сохранять и загружать Z-offset. справа от кнопок смещения у нас есть иконка дискетки(сохранения), но она вам не нужна, сразу после нажатия кнопок смещения данные сохраняются в отдельный файл и подгружаются из него в случае перезагрузки.

</details>

<details><summary>13 screws tilt adjust support </summary>

   Поддержка мода в котором под стол вместо винтов устанавливаются барашки для ручного исправления кривизны стола. ИМХО не нужен и даже вреден. в данном случа мы добавляем дополнительный подпружиненный элемент, который вносит дополнительный фактор нестабильности в и так не лучшим образом работающие тензодатчики. 
   
   *но если звезды зажигают, значит это кому то нужно*

</details>

<details><summary>14 M600 Support</summary>

   Макрос смены филамента. Весьма спорное решение,  описание есть на сайте вики скрипта и мне к нему нечего добавить, несмотря на то что я в свое время инициировал обсуждение и предложил одну из первых его версий, сам лично я разочаровался в его использовании и не рекомендую этот пункт к использованию.

</details>

<details><summary>15 Git Backup</summary>
   
   Добавляет возможность бекапа своих конфигов на предварительно настроенный ваш гитхаб.

   По мне бесполезная свистоперделка сделанная для того чтобы сделать. Не вижу ни одного вменяемого аргумента к использованию.

</details>

<details><summary>16 Moonraker Timelapse</summary>

   1. First item must be preceeded with an empty line.
   1. Markdown renders **perfectly**.
   1. Extra item.

</details>