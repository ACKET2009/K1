[‚Ü©Ô∏è –ù–∞–∑–∞–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é](../readme.md)

---

# üîç –û–ø–∏—Å–∞–Ω–∏–µ custom_macro.py

> –ö–æ–≥–¥–∞ –∫—É–ø–∏–ª –ö1 –¥—É–º–∞—è —á—Ç–æ —Ç–∞–º –æ–±—ã—á–Ω—ã–π Klipper –∏ —Ç–µ–ø–µ—Ä—å —Å–∏–¥–∏—à—å –∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–Ω–∏–º–∞–µ—à—å

<h3 align="right"><a href="https://www.tinkoff.ru/rm/yakovleva.irina203/51ZSr71845" target="_blank">üíù –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∞–≤—Ç–æ—Ä–∞</a></h3>

---

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ

–ü—Ä–æ —Ñ–∞–π–ª–∏–∫ `/usr/share/klipper/klippy/extras/custom_macro.py`

**–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ —Å–æ–±—Ä–∞–Ω–∞ –ø–æ—á—Ç–∏ –≤—Å—è –¥–∏—á—å –∫–æ—Ç–æ—Ä—É—é –≤–Ω–µ—Å–ª–∏ –∫–∏—Ç–∞–π—Å–∫–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏.** –î–ª—è —Ç–µ—Ö –∫—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è Klipper –¥–æ —ç—Ç–æ–≥–æ, –±—É–¥–µ—Ç –ª–µ–≥—á–µ –ø–æ–Ω—è—Ç—å –æ—Ç–ª–∏—á–∏—è –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ Klipper.

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞–∫—Ä–æ—Å–∞

–≠—Ç–æ—Ç –º–∞–∫—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è –∫–ª–∞—Å—Å–æ–º —Å –∏–º–µ–Ω–µ–º `CUSTOM_MACRO`. –í–Ω—É—Ç—Ä–∏ –Ω–µ–≥–æ –µ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—á–∞—Ç—å—é –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π.

### –§—É–Ω–∫—Ü–∏—è `__init__`

–í —Ñ—É–Ω–∫—Ü–∏–∏ `__init__` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–∞–∫—Ä–æ—Å–∞:

- `self.printer = config.get_printer()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ printer
- `self.gcode = self.printer.lookup_object('gcode')` - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ gcode
- `self.pheaters = None` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π pheaters
- `self.heater_hot = None` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π heater_hot
- `self.extruder_temp = None` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π extruder_temp
- `self.bed_temp = None` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π bed_temp
- `self.prtouch = None` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π prtouch

---

## üìù –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã

–î–∞–ª–µ–µ –≤ –º–∞–∫—Ä–æ—Å–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –¥–ª—è G-–∫–æ–¥–∞:

- `CX_PRINT_LEVELING_CALIBRATION` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
- `CX_CLEAN_CALIBRATION_FLAGS` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Ñ–ª–∞–≥–æ–≤ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
- `CX_PRINT_DRAW_ONE_LINE` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è –æ–¥–Ω–æ–π –ª–∏–Ω–∏–∏ –ø–µ—á–∞—Ç–∏
- `CX_ROUGH_G28` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ G28 (–≤–æ–∑–≤—Ä–∞—Ç –æ—Å–µ–π –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ)
- `CX_NOZZLE_CLEAR` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ —Å–æ–ø–ª–∞

---

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

–ó–∞—Ç–µ–º –≤ –º–∞–∫—Ä–æ—Å–µ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:

- `self.default_extruder_temp` - –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `self.default_bed_temp` - –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Å—Ç–æ–ª–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- `self.g28_ext_temp` - —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–∞ G28
- `self.nozzle_clear` - —Ñ–ª–∞–≥ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è, –Ω—É–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ—á–∏—Å—Ç–∫—É —Å–æ–ø–ª–∞
- `self.calibration` - –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ calibration

---

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### cmd_CX_PRINT_LEVELING_CALIBRATION

–í—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∫—Ä–∏–ø—Ç `CHECK_BED_MESH AUTO_G29=1`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ç–∫–∏ —Å—Ç–æ–ª–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏.

### cmd_CX_CLEAN_CALIBRATION_FLAGS

–ü—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `self.leveling_calibration` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ 0.

### cmd_CX_ROUGH_G28

–í—ã–ø–æ–ª–Ω—è–µ—Ç "–≥—Ä—É–±—É—é" –∫–∞–ª–∏–±—Ä–æ–≤–∫—É —Å—Ç–æ–ª–∞:

1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ (`extruder_temp`) –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `EXTRUDER_TEMP`. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`default_extruder_temp`). –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç **180.0 –¥–æ 320.0**.

2. –í—ã—á–∏—Å–ª—è–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã G28 (`g28_ext_temp`) –ø—É—Ç–µ–º –≤—ã—á–∏—Ç–∞–Ω–∏—è 70 –∏–∑ –∑–Ω–∞—á–µ–Ω–∏—è `extruder_temp`. –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–≤—ã—à–∞–µ—Ç 180.0, `g28_ext_temp` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ä–∞–≤–Ω—ã–º 180.0.

3. –ò—â–µ—Ç –æ–±—ä–µ–∫—Ç `prtouch_v2` –∏–ª–∏ `prtouch` –∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç –µ–≥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `prtouch`. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Å—Ç–æ–ª–∞ (`bed_temp`) –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `BED_TEMP`. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`default_bed_temp`). –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç **0.0 –¥–æ 130.0**.

5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `leveling_calibration` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `LEVELING_CALIBRATION`. –ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ —É–∫–∞–∑–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (1).

6. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç—ã G-–∫–æ–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ –∏ —Å—Ç–æ–ª–∞: `M104 S%d` –∏ `M140 S%d`.

7. –í—ã–∑—ã–≤–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç G28 –¥–ª—è –≥—Ä—É–±–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ —Å—Ç–æ–ª–∞.

### cmd_CX_NOZZLE_CLEAR

–í—ã–ø–æ–ª–Ω—è–µ—Ç –æ—á–∏—Å—Ç–∫—É —Å–æ–ø–ª–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞–º–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–∞–Ω–¥—É G-–∫–æ–¥–∞:
```
NOZZLE_CLEAR HOTMIN_TEMP=%d HOTMAX_TEMP=%d BEDMAX_TEMP=%d
```

–ó–Ω–∞—á–µ–Ω–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä –±–µ—Ä—É—Ç—Å—è –∏–∑ `g28_ext_temp`, `extruder_temp` –∏ `bed_temp`.

### cmd_CX_PRINT_DRAW_ONE_LINE

–í—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∏—Å–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–π –ª–∏–Ω–∏–∏ –ø–µ—Ä–µ–¥ –ø–µ—á–∞—Ç—å—é:

1. –ó–∞–ø—É—Å–∫–∞–µ—Ç G-–∫–æ–¥—ã –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç (`M83`)
2. –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –ø–µ—á–∞—Ç–∞—é—â—É—é –≥–æ–ª–æ–≤–∫—É –≤ –Ω–∞—á–∞–ª—å–Ω—É—é —Ç–æ—á–∫—É (`G1 X10 Y10 Z2 F6000`)
3. –û–ø—É—Å–∫–∞–µ—Ç –≥–æ–ª–æ–≤—É (`G1 Z0.1 F600`)
4. –ò—â–µ—Ç –æ–±—ä–µ–∫—Ç—ã `pheaters`, `heater_hot` –∏ `extruder`
5. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ —á–µ—Ä–µ–∑ `M104` –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Å—Ç–æ–ª–∞ —á–µ—Ä–µ–∑ `M140`
6. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —ç–∫—Å—Ç—Ä—É–¥–µ—Ä–∞ —á–µ—Ä–µ–∑ `pheaters.set_temperature` –∏ –æ–∂–∏–¥–∞–µ—Ç
7. –ï—Å–ª–∏ `can_break_flag` —Ä–∞–≤–µ–Ω 3, –º–µ–Ω—è–µ—Ç —Ñ–ª–∞–≥ –Ω–∞ 0 –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—è–¥ –∫–æ–º–∞–Ω–¥ G-–∫–æ–¥–∞

---

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é https://t.me/Ale_xe_y_0 –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª

---

<div align="center">

**[‚Ü©Ô∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é](../readme.md)**

</div>
